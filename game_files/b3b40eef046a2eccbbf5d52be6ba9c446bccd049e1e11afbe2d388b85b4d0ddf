function addDiary(c,b){var e={};c.state.add("diary",{preload:function(){},create:function(){e.seClick=c.add.audio("se-click");e.shopBg=c.add.tileSprite(0,0,640,832,"diary-bg");e.back=c.add.button(20,10,"back",function(i,j){if(b.sound==1){e.seClick.play()}if(e.viewIdolDiary==1){e.idolDiary.destroy();if(e.idolPageNo){e.idolPageNo.destroy()}if(e.idolDiaryBack){e.idolDiaryBack.destroy()}if(e.idolDiaryNext){e.idolDiaryNext.destroy()}e.diaryBg.destroy();e.idolDiaryText1.destroy();e.idolDiaryText2.destroy();e.idolDiaryText3.destroy();e.viewIdolDiary=0;a()}else{c.state.start("stage")}});e.shopTitle=c.add.image(320,50,"diary-title");e.shopTitle.anchor.set(0.5);e.sound=c.add.button(530,10,"sound",function(i,j){if(b.sound==1){b.sound=0;bgmMenu.pause();e.sound.setFrames(0,0,0)}else{b.sound=1;if(bgmMenu==null){bgmMenu=c.add.audio("bgm-menu");bgmMenu.loopFull();bgmMenu.play()}else{bgmMenu.resume()}e.sound.setFrames(1,1,1)}saveGameData(b)},this,b.sound,b.sound,b.sound);e.getStarNum=0;e.getStarData=[];for(var h=1;h<=10;h++){for(var g=1;g<=5;g++){if(b.stage[h][g]==1){e.getStarNum++;e.getStarData.push(h+"-"+g)}}}e.listGroup=null;e.nowPageNo=1;e.viewIdolDiary=0;e.pageMAX=10;if(e.getStarNum==50){e.pageMAX=11;e.getStarData.push(11+"-"+1)}a()},update:function(){}});function a(){if(e.listGroup){e.listGroup.destroy()}e.listGroup=c.add.group();e.diaryBack=c.add.button(80,740,"diary-back",function(i,j){if(b.sound==1){e.seClick.play()}e.nowPageNo=e.nowPageNo-1;a()});e.listGroup.add(e.diaryBack);e.pageNo=c.add.text(320,784,"1 / "+e.pageMAX,{font:"36px Arial",fill:"#fff",stroke:"#000",strokeThickness:10});e.pageNo.anchor.set(0.5);if(e.nowPageNo<1){e.nowPageNo=e.pageMAX}else{if(e.pageMAX<e.nowPageNo){e.nowPageNo=1}}e.pageNo.text=e.nowPageNo+" / "+e.pageMAX;e.listGroup.add(e.pageNo);e.diaryNext=c.add.button(480,740,"diary-next",function(i,j){if(b.sound==1){e.seClick.play()}e.nowPageNo=e.nowPageNo+1;a()});e.listGroup.add(e.diaryNext);var h=110;e.idolBg=[];e.idol=[];e.newView=[];e.idolName=[];e.text=[];e.btnView=[];if(e.nowPageNo==11){g=1;e.idolBg[g]=c.add.button(20,h,"diary-idol-bg6",function(i,j){if(b.sound==1){e.seClick.play()}d(e.nowPageNo,1)});e.idol[g]=c.add.image(70,h+12,"idol48diary");e.idol[g].scale.set(0.25);if(b.diary[e.nowPageNo][1]==0){e.newView[g]=c.add.image(183,h+15,"new-icon");e.newView[g].anchor.set(0.5);c.add.tween(e.newView[g].scale).to({x:1.2,y:1.2},1000,Phaser.Easing.Linear.None,true,0,-1,true)}e.idolName[g]=c.add.text(240,h+25,"クリアー時",{font:"32px Arial",fill:"#fff",stroke:"#000",strokeThickness:8});e.text[g]=c.add.text(240,h+65,"最後の１枚",{font:"32px Arial",fill:"#fff",stroke:"#000",strokeThickness:8});e.btnView[g]=c.add.button(480,h+20,"diary-btn-view",function(i,j){if(b.sound==1){e.seClick.play()}d(e.nowPageNo,1)},1,1,1);e.listGroup.add(e.idolBg[g]);e.listGroup.add(e.idol[g]);if(b.diary[e.nowPageNo][g]==0){e.listGroup.add(e.newView[g])}e.listGroup.add(e.idolName[g]);e.listGroup.add(e.text[g]);e.listGroup.add(e.btnView[g])}else{for(var g in b.stage[e.nowPageNo]){if(b.stage[e.nowPageNo][g]==1){e.idolBg[g]=c.add.button(20,h+((g-1)*125),"diary-idol-bg"+Math.floor((e.nowPageNo-1)/2+1),function(i,j){if(b.sound==1){e.seClick.play()}d(e.nowPageNo,(i.y-110)/125+1)});e.idol[g]=c.add.image(70,h+12+((g-1)*125),"idol"+ImasRunCommon.StageIdolList[e.nowPageNo][g][0]);e.idol[g].scale.set(0.25);if(b.diary[e.nowPageNo][g]==0){e.newView[g]=c.add.image(183,h+12+((g-1)*125),"new-icon");e.newView[g].anchor.set(0.5);c.add.tween(e.newView[g].scale).to({x:1.2,y:1.2},1000,Phaser.Easing.Linear.None,true,0,-1,true)}e.idolName[g]=c.add.text(240,h+25+((g-1)*125),ImasRunCommon.StageIdolList[e.nowPageNo][g][1],{font:"32px Arial",fill:"#fff",stroke:"#000",strokeThickness:8});e.text[g]=c.add.text(240,h+65+((g-1)*125),"との思い出",{font:"32px Arial",fill:"#fff",stroke:"#000",strokeThickness:8});e.btnView[g]=c.add.button(480,h+20+((g-1)*125),"diary-btn-view",function(i,j){if(b.sound==1){e.seClick.play()}d(e.nowPageNo,(i.y-110-20)/125+1)},1,1,1);e.listGroup.add(e.idolBg[g]);e.listGroup.add(e.idol[g]);if(b.diary[e.nowPageNo][g]==0){e.listGroup.add(e.newView[g])}e.listGroup.add(e.idolName[g]);e.listGroup.add(e.text[g]);e.listGroup.add(e.btnView[g])}else{e.idolBg[g]=c.add.image(20,h+((g-1)*125),"diary-idol-bg-disable");e.idolName[g]=c.add.text(240,h+25+((g-1)*125),"????",{font:"32px Arial",fill:"#fff",stroke:"#000",strokeThickness:8});e.text[g]=c.add.text(240,h+65+((g-1)*125),"との思い出",{font:"32px Arial",fill:"#fff",stroke:"#000",strokeThickness:8});e.btnView[g]=c.add.image(480,h+20+((g-1)*125),"diary-btn-view",0);e.listGroup.add(e.idolBg[g]);e.listGroup.add(e.idolName[g]);e.listGroup.add(e.text[g]);e.listGroup.add(e.btnView[g])}}}}function d(g,i){if(e.listGroup){e.listGroup.destroy()}var j=0;if(g==11){j=99}else{j=ImasRunCommon.StageIdolList[g][i][0]}e.viewIdolDiary=1;e.diaryBg=c.add.image(20,100,"diary-page");e.idolDiary=c.add.image(120,120,"diary-idol"+j);if(g==11){e.idolDiaryText1=c.add.text(55,540,ImasRunCommon.ClearDiary[0],{font:"36px Arial",fill:"#000"});e.idolDiaryText2=c.add.text(55,620,ImasRunCommon.ClearDiary[1],{font:"36px Arial",fill:"#000"});e.idolDiaryText3=c.add.text(55,700,ImasRunCommon.ClearDiary[2],{font:"36px Arial",fill:"#000"});b.diary[g][i]=1}else{e.idolDiaryText1=c.add.text(55,540,ImasRunCommon.StageIdolList[g][i][3],{font:"36px Arial",fill:"#000"});e.idolDiaryText2=c.add.text(55,620,ImasRunCommon.StageIdolList[g][i][4],{font:"36px Arial",fill:"#000"});e.idolDiaryText3=c.add.text(55,700,ImasRunCommon.StageIdolList[g][i][5],{font:"36px Arial",fill:"#000"});b.diary[g][i]=1}e.idolPageNo=null;e.idolDiaryBack=null;e.idolDiaryNext=null;if(1<e.getStarNum){var h=f(g,i);e.idolPageNo=c.add.text(320,790,h[4]+" / "+e.getStarData.length,{font:"36px Arial",fill:"#000"});e.idolPageNo.anchor.set(0.5);e.idolDiaryBack=c.add.button(100,750,"diary-back",function(k,l){if(b.sound==1){e.seClick.play()}e.nowPageNo=Number(h[0]);e.idolDiary.destroy();if(e.idolPageNo){e.idolPageNo.destroy()}if(e.idolDiaryBack){e.idolDiaryBack.destroy()}if(e.idolDiaryNext){e.idolDiaryNext.destroy()}e.diaryBg.destroy();e.idolDiaryText1.destroy();e.idolDiaryText2.destroy();e.idolDiaryText3.destroy();d(h[0],h[1])});e.idolDiaryNext=c.add.button(460,750,"diary-next",function(k,l){if(b.sound==1){e.seClick.play()}e.nowPageNo=Number(h[2]);e.idolDiary.destroy();if(e.idolPageNo){e.idolPageNo.destroy()}if(e.idolDiaryBack){e.idolDiaryBack.destroy()}if(e.idolDiaryNext){e.idolDiaryNext.destroy()}e.diaryBg.destroy();e.idolDiaryText1.destroy();e.idolDiaryText2.destroy();e.idolDiaryText3.destroy();d(h[2],h[3])})}localStorage.setItem("imas.game.run",LZString.compress(JSON.stringify(b)))}function f(j,k){var n=0;var g=0;var m=0;var o=0;var h=null;for(var l=0;l<e.getStarData.length;l++){h=e.getStarData[l].split("-");if(j==h[0]&&k==h[1]){if(n==0){h=e.getStarData[e.getStarData.length-1].split("-");n=h[0];g=h[1]}if(l==e.getStarData.length-1){h=e.getStarData[0].split("-");m=h[0];o=h[1]}else{h=e.getStarData[l+1].split("-");m=h[0];o=h[1]}return[n,g,m,o,l+1]}n=h[0];g=h[1]}}};